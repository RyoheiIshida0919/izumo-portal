---
import { getCollection } from 'astro:content';
import BaseLayout from '../../layouts/BaseLayout.astro';
import Breadcrumb from '../../components/common/Breadcrumb.astro';
import AreaCard from '../../components/cards/AreaCard.astro';
import { areas } from '../../content/_meta/areas';

const allServices = await getCollection('services');

// エリア別件数
const areasWithCount = areas.map((area) => ({
  ...area,
  count: allServices.filter((s) => s.data.area === area.id).length,
}));

const pageTitle = 'エリアから探す';
const pageDescription = '出雲市内のエリア別で子育て情報を検索できます。';
---

<BaseLayout title={pageTitle} description={pageDescription}>
  <div class="mx-auto max-w-7xl px-4 sm:px-6 lg:px-8 py-8">
    <Breadcrumb items={[{ label: 'エリアから探す' }]} />

    <h1 class="text-3xl font-bold text-gray-900 mb-4">{pageTitle}</h1>
    <p class="text-gray-600 mb-8">
      出雲市内のエリア別でサービスを検索できます。お住まいの地域や外出先に合わせてお探しください。
    </p>

    <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
      {areasWithCount.map((area) => (
        <AreaCard
          id={area.id}
          name={area.name}
          description={area.description}
          count={area.count}
        />
      ))}
    </div>
  </div>
</BaseLayout>
